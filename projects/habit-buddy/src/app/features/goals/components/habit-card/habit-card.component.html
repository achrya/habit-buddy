<article class="habit-card bg-white border border-slate-100 rounded-2xl p-4 shadow-sm hover:shadow-md transition-shadow relative">
  <!-- Badge Display (Top Right) -->
  <div class="absolute top-3 right-3">
    @if (habit.badge) {
      <div class="badge-container flex items-center justify-center w-10 h-10 rounded-full shadow-sm"
           [class]="getBadgeClasses()"
           [title]="habit.badge.name + ' - ' + habit.badge.description">
        <lucide-icon [img]="getBadgeIcon()" size="20"></lucide-icon>
      </div>
    } @else {
      <div class="badge-container flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 text-gray-500"
           title="New Habit - Start building your streak!">
        <lucide-icon [img]="getBadgeIcon()" size="20"></lucide-icon>
      </div>
    }
  </div>

  <!-- Color Indicator -->
  <div class="flex items-start gap-3">
    <div [style]="'width:4px;height:60px;background:' + habit.color + ';border-radius:2px;margin-top:2px'"></div>
    
    <div class="flex-1 min-w-0 card-content">
      <!-- Title -->
      <div class="mb-4">
        <h3 class="text-lg font-bold text-slate-800 line-clamp-2 ">{{ habit.title }}</h3>
      </div>

      <!-- Stats Section -->
      <div class="stats-section mb-4 p-3 bg-slate-50 rounded-lg">
        <div class="grid grid-cols-2 gap-3 text-center">
          <div>
            <div class="text-2xl font-bold" [style]="'color: ' + habit.color">{{ completedCount() }}</div>
            <div class="text-xs text-slate-500 font-medium">Days Done</div>
          </div>
          <div>
            <div class="text-2xl font-bold" 
                 [class]="stats.current >= 7 ? 'text-red-500' : stats.current >= 3 ? 'text-orange-500' : 'text-slate-600'">
              {{ stats.current }}
            </div>
            <div class="text-xs text-slate-500 font-medium">Current Streak</div>
          </div>
        </div>
      </div>

      <!-- Status Message -->
      <div class="status-message mb-4 p-2 rounded-lg text-center" [class]="getStatusClasses()">
        <p class="text-sm font-medium">{{ getStatusMessage() }}</p>
      </div>

      <!-- Action Buttons -->
      <div class="flex justify-center gap-2">
        <button 
          (click)="onCheckin()"
          [class]="'p-2 rounded-full text-sm transition-all flex-1 max-w-[40px] ' + (isCheckedToday() ? 'bg-emerald-600 text-white shadow-md' : 'bg-slate-50 text-slate-700 hover:bg-slate-100')"
          [title]="isCheckedToday() ? 'Already checked in today!' : 'Check in for today'">
          <lucide-icon [img]="CheckIcon" size="14" class="mx-auto"></lucide-icon>
        </button>
        <button 
          (click)="onEditReminder()"
          class="p-2 rounded-full text-sm bg-yellow-50 text-yellow-700 hover:bg-yellow-100 transition-all flex-1 max-w-[40px]"
          title="Edit reminder">
          <lucide-icon [img]="ClockIcon" size="14" class="mx-auto"></lucide-icon>
        </button>
        <button 
          (click)="onViewCalendar()"
          class="p-2 rounded-full text-sm bg-blue-50 text-blue-700 hover:bg-blue-100 transition-all flex-1 max-w-[40px]"
          title="View calendar">
          <lucide-icon [img]="CalendarIcon" size="14" class="mx-auto"></lucide-icon>
        </button>
        <button 
          (click)="onRemove()"
          class="p-2 rounded-full text-sm text-slate-500 hover:bg-red-50 hover:text-red-600 transition-all flex-1 max-w-[40px]"
          title="Remove habit">
          <lucide-icon [img]="Trash2Icon" size="14" class="mx-auto"></lucide-icon>
        </button>
      </div>
    </div>
  </div>
</article>

<!-- Delete Confirmation Dialog -->
<app-dialog
  [isOpen]="showDeleteDialog()"
  title="Delete Habit"
  [message]="getDeleteMessage()"
  type="danger"
  [buttons]="deleteDialogButtons"
  (close)="onDeleteDialogClose()"
  (buttonClick)="onDeleteDialogAction($event)">
</app-dialog>