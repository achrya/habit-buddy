@if (isOpen()) {
  <div class="fixed inset-0 z-60 flex items-end md:items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" (click)="close()"></div>
    <div class="relative w-full max-w-md bg-white rounded-2xl shadow-xl max-h-[80vh] overflow-auto">
      <!-- Header -->
      <div class="flex items-center justify-between p-6 border-b border-slate-100">
        <div class="flex items-center gap-3">
          <div class="p-2 rounded-full bg-blue-100 text-blue-600">
            <lucide-icon [img]="ClockIcon" size="20"></lucide-icon>
          </div>
          <div>
            <h2 class="text-lg font-semibold text-slate-900">Set Reminder</h2>
            <p class="text-sm text-slate-600">{{ habitTitle }}</p>
          </div>
        </div>
        <button 
          (click)="close()" 
          class="p-1 rounded-full hover:bg-slate-100 transition-colors"
          aria-label="Close">
          <lucide-icon [img]="XIcon" size="20" class="text-slate-500"></lucide-icon>
        </button>
      </div>
      
      <!-- Body -->
      <div class="p-6 space-y-6">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Time</label>
          <input 
            [(ngModel)]="reminderForm.time"
            name="time"
            type="time" 
            class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
        </div>
        
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Days</label>
          <div class="flex flex-wrap gap-2">
            @for (day of weekdayNames; track $index) {
              <button 
                type="button"
                (click)="toggleDay($index)"
                [class]="'px-3 py-2 rounded-lg text-sm font-medium transition-colors ' + (isDaySelected($index) ? 'bg-blue-600 text-white shadow-sm' : 'bg-slate-100 text-slate-700 hover:bg-slate-200')">
                {{ day }}
              </button>
            }
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">
            Notification Window
            <span class="text-xs text-slate-500 font-normal">(minutes)</span>
          </label>
          <input 
            [(ngModel)]="reminderForm.window"
            name="window"
            type="number" 
            min="5" 
            max="1440" 
            step="5" 
            placeholder="120"
            class="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
          <p class="text-xs text-slate-500 mt-1">How many minutes before/after the set time to show notifications</p>
        </div>
      </div>
      
      <!-- Footer -->
      <div class="p-6 pt-0">
        <div class="flex flex-col sm:flex-row gap-3 sm:justify-end">
          <button 
            type="button"
            (click)="close()"
            class="px-4 py-2 rounded-lg font-medium text-slate-700 bg-slate-100 hover:bg-slate-200 transition-colors flex-1 sm:flex-none">
            Cancel
          </button>
          @if (hasExistingReminder()) {
            <button 
              type="button"
              (click)="remove()"
              class="px-4 py-2 rounded-lg font-medium text-red-600 bg-red-50 hover:bg-red-100 transition-colors flex items-center justify-center gap-2 flex-1 sm:flex-none">
              <lucide-icon [img]="Trash2Icon" size="16"></lucide-icon>
              Remove
            </button>
          }
          <button 
            type="button"
            (click)="save()"
            class="px-4 py-2 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 flex-1 sm:flex-none">
            <lucide-icon [img]="SaveIcon" size="16"></lucide-icon>
            Save
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Dialog -->
  <app-dialog
    [isOpen]="showDeleteDialog()"
    title="Remove Reminder"
    [message]="getDeleteMessage()"
    type="danger"
    [buttons]="deleteDialogButtons"
    (close)="onDeleteDialogClose()"
    (buttonClick)="onDeleteDialogAction($event)">
  </app-dialog>
}
